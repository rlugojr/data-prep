<!--
  ~ ============================================================================
  ~
  ~  Copyright (C) 2006-2016 Talend Inc. - www.talend.com
  ~
  ~  This source code is available under agreement available at
  ~  https://github.com/Talend/data-prep/blob/master/LICENSE
  ~
  ~  You should have received a copy of the agreement
  ~  along with this program; if not, write to Talend SA
  ~  9 rue Pages 92150 Suresnes, France
  ~
  ~ ============================================================================
  -->

<div class="preparation-list">
    <div class="preparation" ng-repeat="preparation in preparationListCtrl.state.inventory.preparations track by $index">
        <div class="information">
            <div>
                <talend-editable-text text="preparation.name"
                                      text-class="title one-line"
                                      on-text-click="preparationListCtrl.load(preparation)"
                                      on-validate="preparationListCtrl.rename(preparation, text)"
                                      text-title="{{preparation.name}}"
                                      validate-only-on-change></talend-editable-text>
            </div>
            <p class="description">
                <span translate-once="OWNED_BY"></span> <span class="important" title="{{preparation.author}}" >{{preparation.author}}</span><br/>
                <span translate-once="LAST_MODIFICATION"></span><span translate-once="COLON"></span>{{preparation.lastModificationDate | TDPMoment}}
            </p>

            <p class="details">
                <a data-icon="E" translate-once-title="REPLACE_EXISTING_DATASET" ng-click="preparationListCtrl.showDatasetPicker(preparation)"></a>
                <span class="important name one-line" title="{{preparation.dataset.name}}">
                    {{preparation.dataset.name}}
                </span>
                &nbsp;- {{ preparation.dataset.records}}
                <span translate-once="ROWS"></span>
            </p>
            <p class="details">
                <span class="important">{{preparation.steps.length - 1}}</span> <span class="important" translate-once="STEPS"></span> <span translate-once="RECIPE"></span>
            </p>
        </div>

        <div class="actions">
            <a class="favorite" data-icon="f" ng-class="{selected: preparation.favorite}" ng-click="preparation.favorite = !preparation.favorite"></a>
            <a class="clone-btn" data-icon="B" ng-click="preparationListCtrl.clone(preparation)" id="clone_btn_{{preparation.id}}"></a>
            <a class="trash" data-icon="e" ng-click="preparationListCtrl.remove(preparation)"></a>
        </div>
    </div>
</div>

<talend-modal
        class="dataset-picker-modal"
        fullscreen="false"
        state="preparationListCtrl.displayDatasetPicker"
        close-button="true"
        ng-if="preparationListCtrl.displayDatasetPicker">
    <div class="modal-title" translate-once="REPLACE_EXISTING_DATASET"></div>

    <dataset-picker
            preparation="preparationListCtrl.preparationToUpdate"
            display-picker="preparationListCtrl.displayDatasetPicker">
    </dataset-picker>
</talend-modal>